<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Menú - La Panadería Gourmet</title>
    <link rel="stylesheet" href="styles.css">
    <style>
        body {
            background: white;
            padding: 0;
            margin: 0;
        }

        .page-wrapper {
            display: flex;
            gap: 8mm;
            justify-content: center;
            align-items: flex-start;
            padding: 0;
            width: 100%;
        }

        .print-container {
            box-sizing: border-box;
            flex: 1 1 calc((100% - 8mm) / 2);
            max-width: 148mm; /* A5 width */
            height: 210mm; /* A5 height */
            padding: 5mm;
            border: 1.5px solid #000;
            background: white;
            page-break-inside: avoid;
            overflow: hidden;
            display: flex;
            flex-direction: column;
        }

        header {
            text-align: center;
            margin-bottom: 3mm;
            border-bottom: 1px solid #333;
            padding-bottom: 2mm;
        }

        header h1 {
            font-size: 5.5mm;
            font-weight: 700;
            text-transform: uppercase;
            letter-spacing: 0.3mm;
            margin: 0 0 0.5mm 0;
        }

        header p {
            font-size: 3mm;
            font-style: italic;
            letter-spacing: 0.2mm;
            margin: 0;
        }

        header img {
            width: 24mm;
            height: auto;
            display: block;
            margin: 0 auto 1.5mm;
        }

        main {
            margin-top: 0;
            width: 100%;
            flex: 1;
            display: flex;
            flex-direction: column;
            gap: 2mm;
        }

        section {
            margin-bottom: 0;
            break-inside: avoid;
        }

        section h2 {
            font-size: 4mm;
            font-weight: 700;
            text-transform: uppercase;
            border-bottom: 1px solid #333;
            padding-bottom: 1.2mm;
            margin: 0 0 1.8mm 0;
            letter-spacing: 0.2mm;
        }

        .menu-item {
            display: grid;
            grid-template-columns: 1fr auto;
            align-items: end;
            margin-bottom: 1.8mm;
            position: relative;
        }

        .item-name {
            grid-column: 1;
            grid-row: 1;
            background: white;
            padding-right: 2mm;
            font-size: 3.3mm;
            font-weight: 500;
            line-height: 1.2;
            white-space: normal;
            word-break: break-word;
            overflow-wrap: anywhere;
            position: relative;
            z-index: 1;
        }

        .item-description {
            font-size: 2.8mm;
            color: #666;
            font-style: italic;
        }

        .section-columns {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 8mm;
        }

        .section-columns section {
            margin-bottom: 0;
        }

        .item-price {
            grid-column: 2;
            grid-row: 1;
            justify-self: end;
            background: white;
            padding-left: 2mm;
            font-weight: 700;
            font-size: 3.3mm;
            white-space: nowrap;
            position: relative;
            z-index: 1;
        }

        .logo-placeholder {
            max-width: 100%;
            height: auto;
        }

        .back-link {
            text-align: center;
            margin-top: 1.5rem;
            padding-top: 0.8rem;
            border-top: 2px solid #000;
        }

        .back-link a {
            color: #000;
            text-decoration: none;
            font-weight: bold;
        }

        .back-link a:hover {
            text-decoration: underline;
        }

        /* Print Optimization */
        @media print {
            @page {
                size: A4 landscape;
                margin: 5mm;
            }

            body {
                padding: 0;
                background: white;
                margin: 0;
            }

            .page-wrapper {
                display: flex;
                gap: 5mm;
                padding: 0;
                page-break-inside: avoid;
                justify-content: center;
                align-items: flex-start;
            }

            .print-container {
                border: 1px solid #000;
                padding: 5mm;
                page-break-inside: avoid;
                width: 138mm;
                height: 195mm;
                flex: 0 0 138mm;
                overflow: hidden;
                display: flex;
                flex-direction: column;
            }

            .no-print {
                display: none !important;
            }

            header {
                margin-bottom: 2.2mm;
                padding-bottom: 1.2mm;
            }

            header h1 {
                font-size: 5.2mm;
                margin: 0 0 0.5mm 0;
            }

            header p {
                font-size: 2.8mm;
                margin: 0;
            }

            header img {
                width: 23mm;
                margin-bottom: 1.2mm;
            }

            main {
                margin-top: 0;
                gap: 2.2mm;
                display: flex;
                flex-direction: column;
            }

            section {
                page-break-inside: avoid;
                margin-bottom: 0;
            }

            section h2 {
                font-size: 3.9mm;
                margin: 0 0 1.6mm 0;
                padding-bottom: 1mm;
            }

            .menu-item {
                margin-bottom: 1.6mm;
            }

            .item-name {
                font-size: 3.2mm;
                padding-right: 1.5mm;
            }

            .item-description {
                font-size: 2.7mm;
            }

            .item-price {
                font-size: 3.2mm;
                padding-left: 1.5mm;
            }

            .dots {
                border-bottom: 0.8px dotted #aaa;
            }

            .back-link {
                margin-top: 0;
                padding-top: 0;
                border: none;
                font-size: 0.6rem;
            }
        }
    </style>
</head>
<body>
    <div class="page-wrapper" id="pageWrapper"></div>

    <script>
        async function loadPrintMenu() {
            try {
                const response = await fetch('menu.csv');
                const csvText = await response.text();
                const lines = csvText.trim().split('\n');
                
                const menuData = {};
                const sectionOrder = [];
                
                // Parse CSV
                for (let i = 1; i < lines.length; i++) {
                    const [section, item, description, price] = lines[i].split(',').map(s => s.trim());
                    
                    if (!menuData[section]) {
                        menuData[section] = [];
                        sectionOrder.push(section);
                    }
                    
                    menuData[section].push({ item, description, price });
                }
                
                // Function to create a menu container with specific sections
                function createMenuContainer(sections, showHeader = true) {
                    const container = document.createElement('div');
                    container.className = 'print-container';
                    
                    // Header (only on first page)
                    if (showHeader) {
                        const header = document.createElement('header');
                        
                        const logo = document.createElement('img');
                        logo.src = 'Panaderia.png';
                        logo.alt = 'La Panadería Gourmet';
                        logo.className = 'logo-placeholder';
                        header.appendChild(logo);
                        
                        const title = document.createElement('h1');
                        title.textContent = 'La Panadería Gourmet';
                        header.appendChild(title);
                        
                        const slogan = document.createElement('p');
                        slogan.textContent = 'DISFRUTA NUESTROS PRODUCTOS';
                        header.appendChild(slogan);
                        
                        container.appendChild(header);
                    }
                    
                    // Main content
                    const main = document.createElement('main');

                    function buildSection(section) {
                        const sectionEl = document.createElement('section');
                        const heading = document.createElement('h2');
                        heading.textContent = section;
                        sectionEl.appendChild(heading);

                        menuData[section].forEach(item => {
                            const itemEl = document.createElement('div');
                            itemEl.className = 'menu-item';

                            const nameEl = document.createElement('span');
                            nameEl.className = 'item-name';
                            nameEl.innerHTML = item.item;
                            if (item.description && item.description.length > 0) {
                                nameEl.innerHTML += ` <span class="item-description">(${item.description})</span>`;
                            }
                            itemEl.appendChild(nameEl);

                            const dotsEl = document.createElement('span');
                            dotsEl.className = 'dots';
                            itemEl.appendChild(dotsEl);

                            const priceEl = document.createElement('span');
                            priceEl.className = 'item-price';
                            priceEl.textContent = '$' + item.price;
                            itemEl.appendChild(priceEl);

                            sectionEl.appendChild(itemEl);
                        });

                        return sectionEl;
                    }

                    sections.forEach(s => {
                        if (s === 'De nuestra panadería') {
                            // Create section heading
                            const sectionEl = document.createElement('section');
                            const heading = document.createElement('h2');
                            heading.textContent = s;
                            sectionEl.appendChild(heading);
                            main.appendChild(sectionEl);
                            
                            // Two-column layout for bakery items
                            const columnContainer = document.createElement('div');
                            columnContainer.className = 'section-columns';
                            
                            const halfLength = Math.ceil(menuData[s].length / 2);
                            const firstHalf = menuData[s].slice(0, halfLength);
                            const secondHalf = menuData[s].slice(halfLength);
                            
                            const col1 = document.createElement('div');
                            const col2 = document.createElement('div');
                            
                            firstHalf.forEach(item => {
                                const itemEl = document.createElement('div');
                                itemEl.className = 'menu-item';

                                const nameEl = document.createElement('span');
                                nameEl.className = 'item-name';
                                nameEl.innerHTML = item.item;
                                if (item.description && item.description.length > 0) {
                                    nameEl.innerHTML += ` <span class="item-description">(${item.description})</span>`;
                                }
                                itemEl.appendChild(nameEl);

                                const dotsEl = document.createElement('span');
                                dotsEl.className = 'dots';
                                itemEl.appendChild(dotsEl);

                                const priceEl = document.createElement('span');
                                priceEl.className = 'item-price';
                                priceEl.textContent = '$' + item.price;
                                itemEl.appendChild(priceEl);

                                col1.appendChild(itemEl);
                            });
                            
                            secondHalf.forEach(item => {
                                const itemEl = document.createElement('div');
                                itemEl.className = 'menu-item';

                                const nameEl = document.createElement('span');
                                nameEl.className = 'item-name';
                                nameEl.innerHTML = item.item;
                                if (item.description && item.description.length > 0) {
                                    nameEl.innerHTML += ` <span class="item-description">(${item.description})</span>`;
                                }
                                itemEl.appendChild(nameEl);

                                const dotsEl = document.createElement('span');
                                dotsEl.className = 'dots';
                                itemEl.appendChild(dotsEl);

                                const priceEl = document.createElement('span');
                                priceEl.className = 'item-price';
                                priceEl.textContent = '$' + item.price;
                                itemEl.appendChild(priceEl);

                                col2.appendChild(itemEl);
                            });
                            
                            columnContainer.appendChild(col1);
                            columnContainer.appendChild(col2);
                            main.appendChild(columnContainer);
                        } else {
                            main.appendChild(buildSection(s));
                        }
                    });
                    container.appendChild(main);
                    
                    return container;
                }
                
                // Split menu into two halves - one for each A5 page
                const pageWrapper = document.getElementById('pageWrapper');
                const halfPoint = Math.ceil(sectionOrder.length / 2);
                
                // First A5 page - first half of sections (with header)
                const firstHalf = sectionOrder.slice(0, halfPoint);
                pageWrapper.appendChild(createMenuContainer(firstHalf, true));
                
                // Second A5 page - second half of sections (without header)
                const secondHalf = sectionOrder.slice(halfPoint);
                pageWrapper.appendChild(createMenuContainer(secondHalf, false));
                
            } catch (error) {
                console.error('Error loading menu:', error);
                document.getElementById('pageWrapper').innerHTML = '<p>Error loading menu data</p>';
            }
        }
        
        loadPrintMenu();
    </script>
</body>
</html>
